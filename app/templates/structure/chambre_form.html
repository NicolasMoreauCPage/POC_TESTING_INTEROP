{% extends "base.html" %}

{% block title %}{% if chambre %}Modifier la chambre{% else %}Nouvelle chambre{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight mb-8">
    {% if chambre %}Modifier la chambre {{ chambre.name }}{% else %}Nouvelle chambre dans {{ unite_hebergement.name }}{% endif %}
  </h2>

  <form method="POST" action="{% if chambre %}/structure/chambres/{{ chambre.id }}{% else %}/structure/chambres{% endif %}" class="space-y-6">
    {% if not chambre %}
    <input type="hidden" name="unite_hebergement_id" value="{{ unite_hebergement.id }}">
    {% endif %}

    <div>
      <label for="name" class="block text-sm font-medium leading-6 text-gray-900">Numéro</label>
      <div class="mt-2">
        <input type="text" name="name" id="name" required 
          value="{{ chambre.name if chambre else '' }}"
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
      </div>
    </div>

    <div>
      <label for="identifier" class="block text-sm font-medium leading-6 text-gray-900">Identifiant</label>
      <div class="mt-2">
        <input type="text" name="identifier" id="identifier" required
          value="{{ chambre.identifier if chambre else '' }}"
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
      </div>
      <p class="mt-1 text-xs text-gray-500">Code unique de la chambre (ex : CHU-DEMO-CH-001).</p>
    </div>

    <div>
      <label for="physical_type" class="block text-sm font-medium leading-6 text-gray-900">Type</label>
      <div class="mt-2">
        <select name="physical_type" id="physical_type" required
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600">
          <option value="">Sélectionnez un type</option>
          {% for type in physical_types %}
          <option value="{{ type }}" {% if chambre and chambre.physical_type == type %}selected{% endif %}>
            {{ type }}
          </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div>
      <label for="status" class="block text-sm font-medium leading-6 text-gray-900">Statut</label>
      <div class="mt-2">
        <select name="status" id="status" required
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600">
          {% for status in statuses %}
          <option value="{{ status }}" {% if chambre and chambre.status == status %}selected{% endif %}>
            {{ status }}
          </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div>
      <label for="activation_date" class="block text-sm font-medium leading-6 text-gray-900">Date d'activation</label>
      <div class="mt-2">
        <input type="datetime-local" name="activation_date" id="activation_date"
          value="{{ activation_date_value or '' }}"
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
      </div>
    </div>

    <div>
      <label for="deactivation_date" class="block text-sm font-medium leading-6 text-gray-900">Date de désactivation</label>
      <div class="mt-2">
        <input type="datetime-local" name="deactivation_date" id="deactivation_date"
          value="{{ deactivation_date_value or '' }}"
          class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
      </div>
    </div>

    <div class="flex justify-end gap-x-3">
      <a href="{% if chambre %}/structure/uh/{{ chambre.unite_hebergement_id }}{% else %}/structure/uh/{{ unite_hebergement.id }}{% endif %}" 
         class="rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
        Annuler
      </a>
      <button type="submit" class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
        {% if chambre %}Mettre à jour{% else %}Créer{% endif %}
      </button>
    </div>
  </form>
</div>
{% endblock %}
